[DllImport("coredll.dll")]

public static extern void keybd_event(int vk, byte bScan, int dwFlags, int dwExtraInfo);

public static extern short GetKeyState(int nVirtKey);

const int VK_NUMLOCK = (int)System.Windows.Forms.Keys.NumLock;

const byte KEYEVENTF_KEYUP = 0x0002;

private static void EnableNumLock(){

short keystate = GetKeyState(VK_NUMLOCK);

if (keystate == 0)

{ // Numlock is deactivatied --> activate it

keybd_event(VK_NUMLOCK, 1, 0, 0);

keybd_event(VK_NUMLOCK, 0, KEYEVENTF_KEYUP, 0);

}

}
